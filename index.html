<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiveOps: Performance & Automation 2025</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #0f172a; overflow-x: hidden; }
        .peya-red { color: #E21B23; }
        .peya-bg-red { background-color: #E21B23; }
        .card { background: white; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.04); padding: 2rem; border: 1px solid #e2e8f0; position: relative; }
        .chart-container { position: relative; height: 450px; width: 100%; }
        
        /* Estilo para la caja de Storytelling Interactiva */
        #story-overlay {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            background: rgba(255, 255, 255, 0.98);
            border-left: 5px solid #E21B23;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            padding: 1.5rem;
            border-radius: 12px;
            z-index: 100;
            pointer-events: none;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        #story-overlay.active {
            opacity: 1;
            top: 40px;
        }
        .stat-badge {
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            padding: 2px 8px;
            border-radius: 4px;
            background: #f1f5f9;
            color: #64748b;
            display: inline-block;
        }

        /* Estilos para la línea de tiempo Stagnant */
        .timeline-node {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            border: 4px solid #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 0.7rem;
            color: #94a3b8;
            z-index: 10;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            cursor: pointer;
        }
        .timeline-item:hover .timeline-node {
            border-color: #E21B23;
            color: #E21B23;
            transform: scale(1.1);
        }
        .timeline-item:hover .state-tag {
            background: #fef2f2;
            color: #E21B23;
            border-color: #fecaca;
        }
        .state-tag {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            padding: 6px 10px;
            border-radius: 8px;
            font-size: 0.65rem;
            font-weight: 700;
            color: #64748b;
            text-transform: uppercase;
            transition: all 0.2s;
            white-space: nowrap;
            cursor: pointer;
        }
        /* POPUP PARA GRÁFICOS DE TIMELINE */
        .timeline-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            padding: 1.5rem;
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            max-width: 600px;
            width: 90vw;
        }
        .timeline-popup.active {
            opacity: 1;
            visibility: visible;
        }
        .timeline-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .timeline-popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .timeline-popup-title {
            font-size: 1.25rem;
            font-weight: 800;
            color: #E21B23;
            margin-bottom: 1rem;
            text-transform: uppercase;
        }
        .timeline-popup img {
            width: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* Estilos para la definición de Stagnant */
        .state-chip {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            color: #64748b;
            transition: all 0.2s;
        }
        .state-chip:hover {
            border-color: #E21B23;
            color: #E21B23;
            background: #fffafa;
        }
        .flow-line {
            height: 2px;
            background: #e2e8f0;
            flex-grow: 1;
            margin: 0 8px;
        }

        /* Estilos para los Logros */
        .achievement-card {
            background: #ffffff;
            border: 1px solid #f1f5f9;
            padding: 1.25rem;
            border-radius: 16px;
            transition: transform 0.2s;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }
        .achievement-card:hover {
            transform: translateY(-2px);
            border-color: #fee2e2;
        }
        .case-study-card {
            background: #f8fafc;
            border-top: 4px solid #E21B23;
            padding: 1rem;
            border-radius: 12px;
            transition: all 0.2s;
            cursor: pointer;
            position: relative;
        }
        .case-study-card:hover {
            background: #ffffff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .case-study-graphics {
            display: none;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
            grid-column: 1 / -1;
            animation: slideDown 0.3s ease-out;
        }
        .case-study-graphics.active {
            display: grid;
        }
        .case-study-graphics.two-cols {
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        .case-study-graphics.one-col {
            grid-template-columns: 1fr;
        }
        .case-study-graphics img {
            width: 100%;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        .case-study-graphics img:hover {
            transform: scale(1.02);
        }
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        /* MODAL DE IMÁGENES */
        .image-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .image-modal.active {
            opacity: 1;
            visibility: visible;
        }
        .image-modal-content {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: auto;
        }
        .image-modal img {
            max-width: 90vw;
            max-height: 90vh;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .image-modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 24px;
            color: white;
            transition: all 0.2s ease;
        }
        .image-modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        /* LÓGICA DE CARRUSEL INFINITO */
        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        .carousel-wrapper { width: 100%; overflow: hidden; }
        .stack-carousel {
            display: flex;
            width: max-content;
            animation: scroll 40s linear infinite;
        }
        .stack-carousel:hover { animation-play-state: paused; }
        .stack-item {
            flex: 0 0 auto;
            width: 180px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        .arrow-flow {
            flex: 0 0 auto;
            color: #E21B23;
            font-size: 24px;
            font-weight: 900;
            display: flex;
            align-items: center;
            padding: 0 10px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.3; transform: translateX(-5px); }
            50% { opacity: 1; transform: translateX(5px); }
            100% { opacity: 0.3; transform: translateX(-5px); }
        }

        /* Tabs Técnicas */
        .tech-tab {
            transition: all 0.3s ease;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }
        .tech-tab.active {
            border-bottom-color: #E21B23;
            color: #E21B23;
            font-weight: 800;
        }

        
        /* Estilo Link GitHub */
        .github-link {
            display: contents;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            background: #f1f5f9;
            color: #475569;
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: all 0.2s;
            border: 1px solid #e2e8f0;
        }
        .github-link:hover {
            background: #e2e8f0;
            color: #0f172a;
            border-color: #cbd5e1;
        }

        /* MATRIZ DE DECISIÓN INTERACTIVA */
        .logic-table {
            border-collapse: collapse;
            width: 100%;
        }
        .logic-table th {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: white;
            text-transform: uppercase;
            font-size: 10px;
            letter-spacing: 0.05em;
            padding: 14px;
            font-weight: 800;
            text-align: center;
            border: 1px solid #334155;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .logic-table td {
            padding: 12px 14px;
            font-size: 11px;
            border-bottom: 1px solid #e2e8f0;
            border-right: 1px solid #e2e8f0;
            background: white;
            min-height: 40px;
            display: table-cell;
            vertical-align: middle;
            text-align: center;
        }
        .logic-table tbody tr {
            transition: background-color 0.2s ease;
        }
        .logic-table tbody tr:nth-child(odd) {
            background-color: #f8fafc;
        }
        .logic-table tbody tr:hover {
            background-color: #f1f5f9;
        }
        .logic-table td:first-child {
            font-weight: 700;
            color: #0f172a;
            background: #f8fafc;
            position: sticky;
            left: 0;
            z-index: 5;
            min-width: 140px;
            border-right: 2px solid #e2e8f0;
            text-align: left;
        }
        .logic-table tbody tr:hover td:first-child {
            background-color: #f1f5f9;
        }
        .check-cell {
            cursor: help;
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100%;
        }
        .check-icon { color: #10b981; font-weight: bold; font-size: 1.2rem; }
        .cross-icon { color: #cbd5e1; }
        .tooltip-flip {
            position: relative;
            perspective: 1000px;
        }
        .tooltip-flip-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .tooltip-flip:hover .tooltip-flip-inner {
            transform: rotateY(180deg);
        }
        .tooltip-flip-front, .tooltip-flip-back {
            position: absolute;
            width: 100%;
            backface-visibility: hidden;
        }
        .tooltip-flip-back {
            transform: rotateY(180deg);
        }
        .tooltip-content {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            border: 2px solid #E21B23;
            border-radius: 8px;
            padding: 1rem;
            z-index: 1000;
            min-width: 250px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            pointer-events: none;
            margin-bottom: 10px;
        }
        .check-cell:hover .tooltip-content {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
        .tooltip-content::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid #E21B23;
        }
        .tooltip-label {
            font-weight: 800;
            font-size: 0.75rem;
            color: #E21B23;
            uppercase;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
            letter-spacing: 0.05em;
        }
        .tooltip-detail {
            font-size: 0.7rem;
            color: #475569;
            line-height: 1.4;
        }
        .backup-note-btn {
            cursor: pointer;
            color: #10b981;
            font-weight: bold;
            text-decoration: underline;
            transition: all 0.2s;
        }
        .backup-note-btn:hover {
            color: #E21B23;
            transform: scale(1.05);
        }

        /* SWITCH TOGGLE PARA VISTA DE GRÁFICO */
        .chart-view-toggle {
            display: flex;
            gap: 0;
            background: #f1f5f9;
            border-radius: 8px;
            padding: 2px;
            width: fit-content;
        }
        .toggle-btn {
            padding: 6px 12px;
            border: none;
            background: transparent;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #64748b;
            border-radius: 6px;
        }
        .toggle-btn.active {
            background: white;
            color: #E21B23;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .toggle-btn:hover {
            color: #0f172a;
        }

    </style>
</head>
<body class="p-10">

    <div class="max-w-6xl mx-auto">
        <!-- HEADER EJECUTIVO -->
        <div class="flex justify-between items-end mb-10 border-b pb-6">
            <div>
                <h1 class="text-4xl font-800 tracking-tighter">LiveOps <span class="peya-red">Engine</span> Project</h1>
                <p class="text-slate-500 uppercase text-xs font-bold tracking-[0.2em] mt-2">Automation 3rd Layer | Data 2025</p>
            </div>
            <div class="text-right">
                <p class="text-[10px] font-bold text-slate-400 uppercase">Hito Automation 2025</p>
                <p class="text-3xl font-800 peya-red">47,288 <span class="text-sm font-normal text-slate-400 text-slate-400">Órdenes</span></p>
            </div>
        </div>

        <!-- SECCIÓN INTRODUCTORIA REDISEÑADA -->
        <div class="card mb-10 border-t-8 border-t-red-600">
            <div class="mb-10">
                <h2 class="text-3xl font-800 tracking-tight mb-4 italic text-slate-800">¿Qué es una Orden <span class="peya-red">Stagnant</span>?</h2>
                <div class="flex flex-col md:flex-row md:items-end justify-between gap-6">
                    <p class="text-slate-600 text-lg leading-relaxed max-w-4xl">
                        Es una orden "estancada" que, ya sea por bugs de sistema o mala práctica del rider, permanece en un estado operativo por un tiempo superior al umbral óptimo, generando fricción en la experiencia de usuarios, partners y riders.
                        <br>
                        En 2025 un 12.6% de las órdenes CL estuvieron detenidas al menos 20 minutos en alguno de los principales estados en ciclo de vida de la orden.
                    </p>
                    <div class="flex flex-col gap-3 bg-slate-50 p-4 rounded-xl border border-slate-100 shrink-0">
                        <div class="flex items-center gap-3">
                            <span class="flex h-3 w-3 rounded-full peya-bg-red animate-pulse"></span>
                            <p class="text-[10px] font-black uppercase text-slate-500 tracking-tighter">
                                MAYOR RIESGO FAIL RATE
                            </p>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="flex h-3 w-3 rounded-full peya-bg-red animate-pulse"></span>
                            <p class="text-[10px] font-black uppercase text-slate-500 tracking-tighter">
                                MÁS INEFICIENCIAS OPERATIVAS
                            </p>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="flex h-3 w-3 rounded-full peya-bg-red animate-pulse"></span>
                            <p class="text-[10px] font-black uppercase text-slate-500 tracking-tighter">
                                PEORES EXPERIENCIAS DE USUARIO
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LÍNEA DE TIEMPO FULL WIDTH -->
            <div class="w-full relative py-12">
                <div class="absolute top-[83px] left-0 w-full h-1 bg-slate-100 z-0"></div>
                <div class="relative z-10 flex flex-nowrap justify-between items-start gap-2 overflow-x-auto pt-4 pb-4 px-4">
                    <div class="flex flex-col items-center timeline-item group" data-state="sin-send-to-vendor">
                        <div class="timeline-node mb-4">01</div>
                        <div class="state-tag">Sin Send to Vendor</div>
                    </div>
                    <div class="flex flex-col items-center timeline-item group" data-state="dispatch" data-graph="stack/total_dispatched.png" onclick="showTimelinePopup(event)">
                        <div class="timeline-node mb-4">02</div>
                        <div class="state-tag">Dispatch</div>
                    </div>
                    <div class="flex flex-col items-center timeline-item group" data-state="accepted" data-graph="stack/total_accepted.png" onclick="showTimelinePopup(event)">
                        <div class="timeline-node mb-4">03</div>
                        <div class="state-tag">Accepted</div>
                    </div>
                    <div class="flex flex-col items-center timeline-item group" data-state="near-pickup" data-graph="stack/total_near_pickup.png" onclick="showTimelinePopup(event)">
                        <div class="timeline-node mb-4">04</div>
                        <div class="state-tag">Near Pickup</div>
                    </div>
                    <div class="flex flex-col items-center timeline-item group" data-state="picked-up" data-graph="stack/total_picked_up.png" onclick="showTimelinePopup(event)">
                        <div class="timeline-node mb-4">05</div>
                        <div class="state-tag">Picked Up</div>
                    </div>
                    <div class="flex flex-col items-center timeline-item group" data-state="left-pickup" data-graph="stack/total_left_pickup.png" onclick="showTimelinePopup(event)">
                        <div class="timeline-node mb-4">06</div>
                        <div class="state-tag">Left Pickup</div>
                    </div>
                    <div class="flex flex-col items-center timeline-item group" data-state="near-dropoff" data-graph="stack/total_near_dropoff.png" onclick="showTimelinePopup(event)">
                        <div class="timeline-node mb-4">07</div>
                        <div class="state-tag">Near Dropoff</div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    </div>

    <div class="max-w-6xl mx-auto">
        <!-- NUEVA SECCIÓN: MATRIZ DE DECISIÓN Y LÓGICA -->
        <div class="mt-20">
            <div class="flex justify-between items-end mb-10 border-b pb-6">
                <div>
                    <h1 class="text-4xl font-800 tracking-tighter">Lógica de Gestión <span class="peya-red">Stagnant</span></h1>
                    <p class="text-slate-500 uppercase text-xs font-bold tracking-[0.2em] mt-2">Automation 3rd Layer | Data 2025</p>
                </div>
            </div>

            <div class="grid grid-cols-1 gap-8 mb-10">
                <!-- MATRIZ DE DECISIÓN -->
                <div class="card overflow-x-auto w-full">
                    <h3 class="text-xl font-800 uppercase text-slate-800 mb-6 italic border-l-4 border-red-500 pl-3">Matriz de Validación</h3>
                    <table class="w-full text-left logic-table">
                        <thead>
                            <tr>
                                <th>Stagnant Type</th>
                                <th>Select Zone</th>
                                <th>Exclude Zone</th>
                                <th>Order Status</th>
                                <th>Stagnant Time</th>
                                <th>Rider Status</th>
                                <th>Vehicle Type</th>
                                <th>Stacked Orders</th>
                                <th>Rider PU Distance</th>
                                <th>Rider DO Distance</th>
                                <th>Action</th>
                                <th>Fall Back</th>
                                <th>Backup Note</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- QUEUED -->
                            <tr>
                                <td class="font-bold text-slate-700">Queued</td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Exclude Zone</div><div class="tooltip-detail">Si la ciudad está en lista de exclusión, la orden se descarta de gestión automática.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Queued Status</div><div class="tooltip-detail">Valida que la orden esté en estado Queued en Hurrier.</div></div></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="peya-red font-800 uppercase italic text-xs">Dispatch</td>
                                <td></td>
                                <td><span class="backup-note-btn" onclick="openBackupNote('nota_queued.png')">✓</span></td>
                            </tr>
                            <!-- DISPATCH -->
                            <tr>
                                <td class="font-bold text-slate-700">Dispatch</td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Select Zone</div><div class="tooltip-detail">Zona debe estar activa en configuración regional.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Exclude Zone</div><div class="tooltip-detail">Si la ciudad está excluida, se descarta.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Dispatch Status</div><div class="tooltip-detail">Valida estado Dispatch/Driver Assignment.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Stagnant Time > 25 min</div><div class="tooltip-detail">Umbral: Si el tiempo en Dispatch supera 25 minutos desde asignación.</div></div></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="peya-red font-800 uppercase italic text-xs">Undispatch, Update</td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Fallback</div><div class="tooltip-detail">Si falla undispatch, intenta update en Hurrier.</div></div></td>
                                <td><span class="backup-note-btn" onclick="openBackupNote('nota_dispatch.png')">✓</span></td>
                            </tr>
                            <!-- ACCEPTED -->
                            <tr>
                                <td class="font-bold text-slate-700">Accepted</td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Exclude Zone</div><div class="tooltip-detail">Si zona está excluida, se descarta de gestión.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Accepted Status</div><div class="tooltip-detail">Valida que está en estado Accepted/Driver Accepted.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Stagnant Time > 20 min</div><div class="tooltip-detail">Umbral: Aceptada hace más de 20 minutos.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Rider Break/Off</div><div class="tooltip-detail">Si rider está en Break u Offline, se reasigna.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Bike, Walker, Moto</div><div class="tooltip-detail">Validar tipo de vehículo para ajustar umbrales.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Stacked Orders</div><div class="tooltip-detail">Si rider tiene múltiples órdenes stacked, análisis de impacto.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">PU Distance > 200m</div><div class="tooltip-detail">Si distancia a pickup > 200m, se considera crítica.</div></div></td>
                                <td></td>
                                <td class="peya-red font-800 uppercase italic text-xs">Undispatch</td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Fallback</div><div class="tooltip-detail">Si undispatch falla, intenta reasignación forzada.</div></div></td>
                                <td><span class="backup-note-btn" onclick="openBackupNote('nota_accepted.png')">✓</span></td>
                            </tr>
                            <!-- NEAR PICKUP -->
                            <tr>
                                <td class="font-bold text-slate-700">Near Pickup</td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Exclude Zone</div><div class="tooltip-detail">Validar si zona está en lista de exclusión.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Near Pickup Status</div><div class="tooltip-detail">Estado: Near Pickup Location.</div></div></td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Rider Break/Off</div><div class="tooltip-detail">Si rider está en Break/Off, reasignar.</div></div></td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Sin Stacking</div><div class="tooltip-detail">Preferente en órdenes sin múltiples asignaciones.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">PU Distance > 100m</div><div class="tooltip-detail">Distancia crítica para Near Pickup: > 100m.</div></div></td>
                                <td></td>
                                <td class="peya-red font-800 uppercase italic text-xs">Undispatch</td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Fallback</div><div class="tooltip-detail">Reasignación Hard o Soft según disponibilidad.</div></div></td>
                                <td><span class="backup-note-btn" onclick="openBackupNote('nota_near_pickup.png')">✓</span></td>
                            </tr>
                            <!-- PICKED UP -->
                            <tr>
                                <td class="font-bold text-slate-700">Picked Up</td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Exclude Zone</div><div class="tooltip-detail">Validar exclusión de zona.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Picked Up Status</div><div class="tooltip-detail">Estado: Order Picked Up / En Ruta.</div></div></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Sin Stacking</div><div class="tooltip-detail">Si hay stacking, análisis de priorización de delivery.</div></div></td>
                                <td></td>
                                <td></td>
                                <td class="peya-red font-800 uppercase italic text-xs">Complete</td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Fallback</div><div class="tooltip-detail">Si no se puede completar, contact rider.</div></div></td>
                                <td><span class="backup-note-btn" onclick="openBackupNote('nota_picked_up.png')">✓</span></td>
                            </tr>
                            <!-- LEFT PICKUP -->
                            <tr>
                                <td class="font-bold text-slate-700">Left Pickup</td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Exclude Zone</div><div class="tooltip-detail">Validar exclusión.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Left Pickup Status</div><div class="tooltip-detail">Estado: Rider Left Pickup Location.</div></div></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Sin Stacking</div><div class="tooltip-detail">Orden en tránsito sin stacking.</div></div></td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Validate DO Distance</div><div class="tooltip-detail">Distancia al punto de entrega.</div></div></td>
                                <td class="peya-red font-800 uppercase italic text-xs">Complete</td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Fallback</div><div class="tooltip-detail">Escalación a revisión manual si hay retrasos.</div></div></td>
                                <td><span class="backup-note-btn" onclick="openBackupNote('nota_left_pickup.png')">✓</span></td>
                            </tr>
                            <!-- NEAR DROPOFF -->
                            <tr>
                                <td class="font-bold text-slate-700">Near Dropoff</td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Exclude Zone</div><div class="tooltip-detail">Validar exclusión.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Near Dropoff Status</div><div class="tooltip-detail">Estado: Rider Near Dropoff Location.</div></div></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">DO Distance < 100m</div><div class="tooltip-detail">Distancia al punto de entrega < 100m.</div></div></td>
                                <td class="peya-red font-800 uppercase italic text-xs">Complete</td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Fallback</div><div class="tooltip-detail">AutoComplete forzado si PIN timeouts.</div></div></td>
                                <td><span class="backup-note-btn" onclick="openBackupNote('nota_near_dropoff.png')">✓</span></td>
                            </tr>
                            <!-- SEND TO VENDOR -->
                            <tr>
                                <td class="font-bold text-slate-700">Send to Vendor</td>
                                <td></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Exclude Zone</div><div class="tooltip-detail">Validar zona para STV.</div></div></td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">STV Status</div><div class="tooltip-detail">Estado: Send to Vendor elegible.</div></div></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="peya-red font-800 uppercase italic text-xs">Update, STV</td>
                                <td class="check-cell"><span class="check-icon">✓</span><div class="tooltip-content"><div class="tooltip-label">Fallback</div><div class="tooltip-detail">Retry STV o escalación manual.</div></div></td>
                                <td><span class="backup-note-btn" onclick="openBackupNote('nota_send_to_vendor.png')">✓</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- ACCIONES PREVIAS -->
                <div class="card bg-slate-50 border-none">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-white font-black text-xs">PRE</div>
                        <h3 class="text-lg font-800 uppercase text-slate-800 italic">Protocolo Pre-Acción</h3>
                    </div>
                    <ul class="space-y-4">
                        <li class="flex gap-3">
                            <span class="text-red-500 font-bold">1.</span>
                            <p class="text-xs font-semibold text-slate-700">Sincronización BigQuery-Sheets: Filtrado de órdenes con >X minutos de estancamiento.</p>
                        </li>
                        <li class="flex gap-3">
                            <span class="text-red-500 font-bold">2.</span>
                            <p class="text-xs font-semibold text-slate-700">Validación de Exclusión: El motor verifica si la ciudad o zona está en la "lista blanca" de gestión activa.</p>
                        </li>
                        <li class="flex gap-3">
                            <span class="text-red-500 font-bold">3.</span>
                            <p class="text-xs font-semibold text-slate-700">Health Check Driver: Confirmación de sesión Okta activa antes de iniciar scraping individual.</p>
                        </li>
                    </ul>
                </div>

                <!-- ACCIONES POSTERIORES -->
                <div class="card bg-red-50/30 border-none">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="w-10 h-10 rounded-full peya-bg-red flex items-center justify-center text-white font-black text-xs">POST</div>
                        <h3 class="text-lg font-800 uppercase text-slate-800 italic">Protocolo Post-Acción</h3>
                    </div>
                    <ul class="space-y-4">
                        <li class="flex gap-3">
                            <span class="text-red-500 font-bold">1.</span>
                            <p class="text-xs font-semibold text-slate-700">Escritura de Log en Hurrier: Inyección de nota técnica para visibilidad de los analistas manuales.</p>
                        </li>
                        <li class="flex gap-3">
                            <span class="text-red-500 font-bold">2.</span>
                            <p class="text-xs font-semibold text-slate-700">Update Histórico: Registro de la gestión exitosa en la base de datos de impacto (Rising LiveOps).</p>
                        </li>
                        <li class="flex gap-3">
                            <span class="text-red-500 font-bold">3.</span>
                            <p class="text-xs font-semibold text-slate-700">Notificación Slack (Alerting): Si la gestión falla tras 3 intentos, se deriva a canal de revisión manual.</p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- SECCIÓN TÉCNICA: HEADER EJECUTIVO -->
        <div class="flex justify-between items-end mt-16 mb-10 border-b pb-6">
            <div>
                <h1 class="text-4xl font-800 tracking-tighter">LiveOps <span class="peya-red">Engine</span> Architecture</h1>
                <p class="text-slate-500 uppercase text-xs font-bold tracking-[0.2em] mt-2">Automation 3rd Layer | Data 2025</p>
            </div>
        </div>

        <!-- SECCIÓN ARQUITECTURA TÉCNICA (INTERACTIVA) -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-20">
            <div class="col-span-1 space-y-2">
                <p class="text-[10px] font-black uppercase text-slate-400 mb-4 tracking-widest">Capas del Proyecto</p>
                <div onclick="switchTech('dev')" id="tab-dev" class="tech-tab active p-4 rounded-xl bg-white border hover:shadow-md">
                    <p class="text-xs font-bold uppercase">01. Development</p>
                    <p class="text-[10px] text-slate-500">Python, SOLID & Seguridad</p>
                </div>
                <div onclick="switchTech('ui')" id="tab-ui" class="tech-tab p-4 rounded-xl bg-white border hover:shadow-md">
                    <p class="text-xs font-bold uppercase">02. Interface</p>
                    <p class="text-[10px] text-slate-500">PyQt5 & Paneles UI</p>
                </div>
                <div onclick="switchTech('ctrl')" id="tab-ctrl" class="tech-tab p-4 rounded-xl bg-white border hover:shadow-md">
                    <p class="text-xs font-bold uppercase">03. Controller</p>
                    <p class="text-[10px] text-slate-500">Patrón MVC & Concurrencia</p>
                </div>
                
                
                <p class="text-[10px] font-black uppercase text-slate-400 mb-4 mt-6 tracking-widest">Documentación</p>
                <div class="space-y-2">
                    <a href="https://gist.github.com/Jotaem/03aabe9e1d0beaa762ace1690f2e6472" target="_blank" class="flex items-center gap-3 px-4 py-3 rounded-xl bg-white border hover:shadow-md transition-all duration-200 w-full">
                        <img src="https://cdn.worldvectorlogo.com/logos/github-icon-1.svg" class="h-5" alt="GitHub">
                        <span class="text-xs font-bold text-slate-800 uppercase">README.md</span>
                    </a>
                    <a href="https://gist.github.com/Jotaem/689cfdfea30c0a5bd42de3cccf5dd7fd" target="_blank" class="flex items-center gap-3 px-4 py-3 rounded-xl bg-white border hover:shadow-md transition-all duration-200 w-full">
                        <img src="https://cdn.worldvectorlogo.com/logos/github-icon-1.svg" class="h-5" alt="GitHub">
                        <span class="text-xs font-bold text-slate-800 uppercase">DIRECTORIO.md</span>
                    </a>
                    <a href="https://gist.github.com/Jotaem/9b02a31b7c0b98fd33d64b62419fb2fb" target="_blank" class="flex items-center gap-3 px-4 py-3 rounded-xl bg-white border hover:shadow-md transition-all duration-200 w-full">
                        <img src="https://cdn.worldvectorlogo.com/logos/github-icon-1.svg" class="h-5" alt="GitHub">
                        <span class="text-xs font-bold text-slate-800 uppercase">ARCHITECTURE.md</span>
                    </a>
                </div>
            </div>

            <div class="col-span-3 card min-h-[500px]" id="tech-content">
                <!-- Inyectado vía JS -->
            </div>
        </div>

    
        <!-- SECCIÓN STACK FLOW -->
        <div class="card mb-10 bg-slate-800 overflow-hidden py-8">
            <p class="text-[10px] font-white uppercase text-red-500 tracking-[0.3em] mb-8 text-center">Stagnant Execution Flow</p>
            <div class="stack-carousel">
                <div class="stack-item"><img src="stack/bigquery.svg" class="h-12" alt="BigQuery"><span class="text-white text-[10px] font-bold uppercase">BigQuery</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="https://www.gstatic.com/images/branding/product/2x/sheets_64dp.png" class="h-12" alt="Sheets"><span class="text-white text-[10px] font-bold uppercase">G-Sheets</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="https://cdn.worldvectorlogo.com/logos/python-5.svg" class="h-12" alt="Python Engine"><span class="text-white text-[10px] font-bold uppercase italic">Engine</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="stack/selenium.png" class="h-12" alt="Selenium"><span class="text-white text-[10px] font-bold uppercase">Selenium</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="stack/hurrier.png" class="h-12 w-12 rounded-full object-cover bg-white p-1" alt="Hurrier"><span class="text-white text-[10px] font-bold uppercase">Hurrier</span></div>
            </div>
        </div>

        <!-- SECCIÓN STACK FLOW -->
        <div class="card mb-10 bg-slate-800 overflow-hidden py-8">
            <p class="text-[10px] font-white uppercase text-red-500 tracking-[0.3em] mb-8 text-center">Reporting Execution Flow</p>
            <div class="stack-carousel">
                <div class="stack-item"><img src="https://cdn.worldvectorlogo.com/logos/python-5.svg" class="h-12" alt="Python Engine"><span class="text-white text-[10px] font-bold uppercase italic">Engine</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="stack/hurrier.png" class="h-12 w-12 rounded-full object-cover bg-white p-1" alt="Hurrier"><span class="text-white text-[10px] font-bold uppercase">Hurrier</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="https://cdn.worldvectorlogo.com/logos/grafana.svg" class="h-12" alt="Grafana"><span class="text-white text-[10px] font-bold uppercase">Grafana</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="https://www.gstatic.com/images/branding/product/2x/sheets_64dp.png" class="h-12" alt="Sheets"><span class="text-white text-[10px] font-bold uppercase">G-Sheets</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="stack/slack.png" class="h-12" alt="Slack"><span class="text-white text-[10px] font-bold uppercase">Slack</span></div>
            </div>
        </div>

        <!-- SECCIÓN STACK FLOW -->
        <div class="card mb-10 bg-slate-800 overflow-hidden py-8">
            <p class="text-[10px] font-white uppercase text-red-500 tracking-[0.3em] mb-8 text-center">DAS Events Execution Flow</p>
            <div class="stack-carousel">
                <div class="stack-item"><img src="stack/hurrier.png" class="h-12 w-12 rounded-full object-cover bg-white p-1" alt="Hurrier"><span class="text-white text-[10px] font-bold uppercase">Hurrier</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="stack/bigquery.svg" class="h-12" alt="BigQuery"><span class="text-white text-[10px] font-bold uppercase">BigQuery</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="stack/gemini.png" class="h-12" alt="Gemini"><span class="text-white text-[10px] font-bold uppercase">Gemini</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="https://cdn.worldvectorlogo.com/logos/python-5.svg" class="h-12" alt="Python Engine"><span class="text-white text-[10px] font-bold uppercase italic">Engine</span></div>
                <div class="flex items-center arrow-flow px-4"><span class="text-2xl">→</span></div>
                <div class="stack-item"><img src="stack/das.jpg" class="h-12" alt="DAS"><span class="text-white text-[10px] font-bold uppercase">DAS</span></div>
            </div>
        </div>

        <!-- HEADER EJECUTIVO -->
        <div class="flex justify-between items-end mb-10 border-b pb-6">
            <div>
                <h1 class="text-4xl font-800 tracking-tighter">LiveOps <span class="peya-red">Engine</span> Performance</h1>
                <p class="text-slate-500 uppercase text-xs font-bold tracking-[0.2em] mt-2">Automation 3rd Layer | Data 2025</p>
            </div>
            <div class="text-right">
                <p class="text-[10px] font-bold text-slate-400 uppercase">Hito Automation 2025</p>
                <p class="text-3xl font-800 peya-red">47,288 <span class="text-sm font-normal text-slate-400 text-slate-400">Órdenes</span></p>
            </div>
        </div>

        <!-- SECCIÓN DE EVOLUCIÓN OPERATIVA Y LOGROS -->
        <div class="grid grid-cols-1 gap-10 mt-20">
            
            <!-- GRÁFICO 1: EVOLUCIÓN DE LA AUTOMATIZACIÓN (CON STORYTELLING) -->
            <div class="card overflow-hidden">
                <div class="flex justify-between items-start mb-6">
                    <div>
                        <h2 class="text-2xl font-bold tracking-tight">Evolución Operativa</h2>
                        <p class="text-slate-400 text-sm">Pasa el cursor sobre los meses para ver el detalle táctico</p>
                    </div>
                    <div class="flex gap-4">
                        <div class="chart-view-toggle">
                            <button class="toggle-btn active" onclick="switchChartView('engine-manual')" id="toggleEngineManual">Engine / Manual</button>
                            <button class="toggle-btn" onclick="switchChartView('by-state')" id="toggleByState">Por Estado</button>
                        </div>
                    </div>
                </div>

                <!-- LEYENDA DINÁMICA -->
                <div id="chartLegend" class="flex gap-4 mb-4 flex-wrap">
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full peya-bg-red"></span>
                        <span class="text-xs font-bold text-slate-600 uppercase">Engine</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full bg-slate-300"></span>
                        <span class="text-xs font-bold text-slate-600 uppercase">Manual</span>
                    </div>
                </div>

                <!-- CAJA DE STORYTELLING DINÁMICA -->
                <div id="story-overlay">
                    <div class="flex justify-between items-center">
                        <span id="story-month" class="text-lg font-800 peya-red uppercase tracking-widest">ENERO</span>
                        <span id="story-tag" class="stat-badge">Hito Operativo</span>
                    </div>
                    <p id="story-text" class="text-slate-700 text-sm leading-relaxed font-medium">
                        Selecciona un mes para ver el contexto.
                    </p>
                </div>
                
                <div class="chart-container mt-12">
                    <canvas id="automationChart"></canvas>
                </div>

            
                <!-- LOGROS E INDICADORES DE ÉXITO -->
                <div class="mt-10">
                    <p class="text-[10px] font-black uppercase text-slate-400 tracking-[0.2em] mb-4">Resultados Consolidados Diciembre</p>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                        <div class="achievement-card">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="text-2xl">🤖</span>
                                <p class="text-[10px] uppercase font-black text-slate-400 tracking-wider leading-none">Share de<br>Automatización</p>
                            </div>
                            <p class="text-2xl font-800 peya-red">88%</p>
                            <p class="text-[10px] text-slate-500 mt-1">Máximo histórico alcanzado en Diciembre.</p>
                        </div>
                        
                        <div class="achievement-card">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="text-2xl">🚀</span>
                                <p class="text-[10px] uppercase font-black text-slate-400 tracking-wider leading-none">Aumento de<br>Capacidad</p>
                            </div>
                            <p class="text-2xl font-800 peya-red">22.1k</p>
                            <p class="text-[10px] text-slate-500 mt-1">Órdenes gestionadas en un solo mes.</p>
                        </div>

                        <div class="achievement-card">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="text-2xl">🎯</span>
                                <p class="text-[10px] uppercase font-black text-slate-400 tracking-wider leading-none">Efectividad<br>Sostenida</p>
                            </div>
                            <p class="text-2xl font-800 peya-red">>86%</p>
                            <p class="text-[10px] text-slate-500 mt-1">Tasa de éxito bajo alta demanda operacional.</p>
                        </div>

                        <div class="achievement-card border-red-100 bg-red-50/30">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="text-2xl">🏆</span>
                                <p class="text-[10px] uppercase font-black text-slate-400 tracking-wider leading-none">Hito de<br>Eficiencia</p>
                            </div>
                            <p class="text-xl font-800 text-slate-800">1 Mes ≈ 1 Año</p>
                            <p class="text-[10px] text-slate-500 mt-1">Igualamos la gestión manual total de 2024.</p>
                        </div>
                    </div>

                    <p class="text-[10px] font-black uppercase text-slate-400 tracking-[0.2em] mb-4">Casos de Éxito Tácticos</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="case-studies-container">
                        <div class="case-study-card" onclick="toggleGraphics(event, 'ndo')">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-lg">📍</span>
                                <h3 class="text-xs font-800 uppercase tracking-tight">Caso Near Dropoff</h3>
                            </div>
                            <p class="text-[10px] text-slate-600 leading-snug">
                                <strong class="text-slate-900">Resultado: 0% Stagnant NDO.</strong> Eliminación total de órdenes estancadas mediante el ajuste de umbrales de autocomplete en órdenes con PIN (180' → 40').
                            </p>
                            <div class="case-study-graphics two-cols" id="ndo-graphics">
                                <img src="stack/gestion ice autocomplete.png" alt="Gestión ICE Autocomplete">
                                <img src="stack/share_gestion_stagnant.png" alt="Share Gestión Stagnant">
                            </div>
                        </div>
                        <div class="case-study-card" onclick="toggleGraphics(event, 'accepted')">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-lg">⏱️</span>
                                <h3 class="text-xs font-800 uppercase tracking-tight">Caso Accepted</h3>
                            </div>
                            <p class="text-[10px] text-slate-600 leading-snug">
                                <strong class="text-slate-900">Gestión Tercera Capa.</strong> Los automatismos (ICE) solo capturan entre el 20-30% de los casos. El Engine cubre el GAP restante reduciendo FR de 21.8% (Sin gestión) a 11.8% (Gestión óptima).
                            </p>
                            <div class="case-study-graphics two-cols" id="accepted-graphics">
                                <img src="stack/accepted_1.png" alt="Accepted Case 1">
                                <img src="stack/accepted_2.png" alt="Accepted Case 2">
                            </div>
                        </div>
                        <div class="case-study-card" onclick="toggleGraphics(event, 'flota')">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-lg">⚡</span>
                                <h3 class="text-xs font-800 uppercase tracking-tight">Eficiencia de Flota</h3>
                            </div>
                            <p class="text-[10px] text-slate-600 leading-snug">
                                <strong class="text-slate-900">Reducción Fake Hours.</strong> Libera a rider para nuevos pedidos y corrige WH (3k - 5k horas falsas/mes ).
                            </p>
                            <div class="case-study-graphics one-col" id="flota-graphics">
                                <img src="stack/fake_wh.png" alt="Fake Working Hours">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GRÁFICO 2: EFECTIVIDAD -->
            <div class="card">
                <div class="mb-8">
                    <h2 class="text-2xl font-bold tracking-tight">Efectividad de Gestión (EG%)</h2>
                    <p class="text-slate-400 text-sm italic">Proporción de Órdenes Confirmadas vs. Total Gestión</p>
                </div>
                
                <div class="chart-container" style="height: 300px;">
                    <canvas id="effectivenessChart"></canvas>
                </div>

                <div class="mt-8 flex items-center justify-between p-4 bg-slate-50 rounded-xl border-l-4 border-red-500">
                    <div>
                        <p class="text-sm font-bold text-slate-700">Insights de Rendimiento</p>
                        <p class="text-xs text-slate-500">A pesar del incremento masivo de volumen (+4x vs Agosto), la efectividad de gestión (EG) se mantiene estable sobre el 86%.</p>
                        <p class="text-xs text-slate-500">La mejora en la tasa de éxito entre el Q1 y Q4 es de +21.3 pp.</p>
                    </div>
                    <div class="text-right">
                        <p class="text-[10px] uppercase font-bold text-slate-400">EG Q1-2025</p>
                        <p class="text-xl font-800 peya-red">67.3%</p>
                    </div>
                    <div class="text-center">
                        <p class="text-slate-500 font-500 peya-red">VS</p>
                    </div>
                    <div class="text-right">
                        <p class="text-[10px] uppercase font-bold text-slate-400">EG Q4-2025</p>
                        <p class="text-xl font-800 peya-red">89.0%</p>
                    </div>
                </div>
            </div>

        </div>

            <!-- FOOTER EJECUTIVO -->
            <footer class="mt-20 border-t border-slate-200 pt-10 pb-20">
                <div class="flex flex-col md:flex-row justify-between items-center gap-8">
                    <div class="flex flex-col items-center md:items-start">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="w-2 h-2 rounded-full peya-bg-red"></span>
                            <span class="text-sm font-800 tracking-tighter uppercase">LiveOps <span class="peya-red">Engine</span> Excellence</span>
                        </div>
                        <p class="text-[10px] text-slate-400 font-medium uppercase tracking-widest">Desarrollado para la optimización de flota y logística</p>
                    </div>
                    
                    <div class="flex items-center gap-10">
                        <div class="text-center md:text-right">
                            <p class="text-[10px] font-black text-slate-400 uppercase mb-1">Autor del Proyecto</p>
                            <p class="text-sm font-bold text-slate-700">Jonathan Matus</p>
                        </div>
                        <div class="h-8 w-[1px] bg-slate-200 hidden md:block"></div>
                        <div class="text-center md:text-right">
                            <p class="text-[10px] font-black text-slate-400 uppercase mb-1">Última Actualización</p>
                            <p class="text-sm font-bold text-slate-700">Enero 2026</p>
                        </div>
                    </div>

                    <div class="flex items-center gap-4">
                        <a href="https://github.com/Jotaem/Automatizacion_LiveOps3.0" target="_blank" class="github-link">
                            <img src="https://cdn.worldvectorlogo.com/logos/github-icon-1.svg" class="h-4" alt="GitHub Logo">
                            Código Fuente
                        </a>
                    </div>
                </div>
                <div class="mt-10 text-center">
                    <p class="text-[9px] text-slate-300 font-bold uppercase tracking-[0.4em]">Efficiency · Scalability · Innovation</p>
                </div>
            </footer>
    </div>

    <!-- MODAL DE IMÁGENES -->
    <div class="image-modal" id="imageModal" onclick="closeImageModal()">
        <div class="image-modal-content" onclick="event.stopPropagation()">
            <div class="image-modal-close" onclick="closeImageModal()">✕</div>
            <img id="modalImage" src="" alt="Gráfico expandido">
        </div>
    </div>

    <!-- POPUP PARA GRÁFICOS DE TIMELINE -->
    <div class="timeline-popup-overlay" id="timelinePopupOverlay" onclick="closeTimelinePopup()"></div>
    <div class="timeline-popup" id="timelinePopup" onclick="event.stopPropagation()">
        <div class="timeline-popup-title" id="timelinePopupTitle"></div>
        <img id="timelinePopupImage" src="" alt="Gráfico timeline">
    </div>

    <!-- POPUP PARA NOTAS DE RESPALDO -->
    <div class="image-modal" id="backupNoteModal" onclick="closeBackupNote()">
        <div class="image-modal-content" onclick="event.stopPropagation()">
            <div class="image-modal-close" onclick="closeBackupNote()">✕</div>
            <img id="backupNoteImage" src="" alt="Nota de respaldo">
        </div>
    </div>

    <script>

        <!-- LIVEOPS ENGINE ARCHITECTURE -->
        // DATOS TÉCNICOS
        const techData = {
            dev: {
                title: "01. Desarrollo (Python Al3)",
                desc: "Solución local que actúa como tercera capa de gestión sobre las limitaciones de Hurrier e ICE.",
                bullets: [
                    "Diseño bajo principios SOLID para escalabilidad y robustez.",
                    "Seguridad: Login manual en Okta y credenciales encriptadas.",
                    "Entorno Seguro: Servidor local sin exposición en la nube pública.",
                    "Documentación: Repositorio privado con README y Architecture Docs."
                ],
                image: "stack/documentacion.gif"
            },
            ui: {
                title: "02. Interface Layer (PyQt5 Panels)",
                desc: "Interfaz gráfica moderna y modular construida con PyQt5 para una navegación fluida, emulando la eficiencia de una hoja de cálculo.",
                bullets: [
                    "Paneles Principales: Reporting, Stagnant y DAS.",
                    "Herramientas: Dashboard personalizable de enlaces tácticos.",
                    "Schedulers: Control de ejecución automática (Dual o 15-30-60 min).",
                    "Rider Care: Exclusión dinámica de ciudades en tiempo real y no tocar ciudades que requieran una revisión manual caso a caso (paro)",
                    "Configuración: Login de usuario, feedback auditivo, seteo de canales y umbrales."
                ],
                image: "stack/interfaz.gif"
            },
            ctrl: {
                title: "03. Controller Layer (Patrón MVC)",
                desc: "Motor central (app_controller.py) que desacopla completamente la interfaz gráfica de la lógica de negocio. La UI emite señales; el controlador orquesta la ejecución.",
                bullets: [
                    "Concurrencia Segura: Gestión simultánea de tareas manuales y automáticas.",
                    "Multi-threading: Drivers independientes (Visible para usuario, Headless para Schedulers).",
                    "Trazabilidad: Captura de excepciones y logs específicos por hilo de ejecución.",
                    "Cero UI Freezing: Procesamiento asíncrono que garantiza la respuesta de la interfaz."
                ],
                image: "stack/ejecucion_bot.gif"
            }
        };

        function switchTech(key) {
            const data = techData[key];
            const container = document.getElementById('tech-content');
            document.querySelectorAll('.tech-tab').forEach(t => t.classList.remove('active'));
            document.getElementById('tab-' + key).classList.add('active');

            container.innerHTML = `
                <div class="animate-fadeIn">
                    <h2 class="text-2xl font-800 peya-red mb-4 italic">${data.title}</h2>
                    <p class="text-slate-600 mb-6 text-sm leading-relaxed">${data.desc}</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <ul class="space-y-3">
                            ${data.bullets.map(b => `<li class="flex items-center gap-2 text-xs font-bold text-slate-700"><span class="text-red-500 text-lg leading-none">✓</span> ${b}</li>`).join('')}
                        </ul>
                        <div class="bg-slate-100 rounded-xl p-4 border-2 border-dashed border-slate-300 flex flex-col items-center justify-center">
                            <img src="${data.image}" onerror="this.src='https://placehold.co/400x250?text=Cargar+Captura+${key}';" class="rounded shadow-lg max-h-50 mb-2">
                        </div>
                    </div>
                </div>
            `;
        }

        const mesesLabels = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];

        // DATA REAL VALIDADA - ENGINE/MANUAL
        const dataEngine = [0, 0, 0, 0, 0, 0, 0, 4418, 3506, 7374, 12536, 19454];
        const dataManual = [521, 1281, 1563, 1717, 3730, 4491, 5230, 4672, 2950, 2780, 2677, 2703];
        const dataEfectividad = [68.57, 62.53, 69.87, 68.03, 80.88, 83.12, 86.21, 89.33, 85.05, 84.54, 87.24, 86.96];

        // SEGMENTATION DATA (TABLA REAL)
        const sAccepted = [835, 654, 1055, 580, 1047, 960, 1176, 1683, 2128, 4936, 9208, 14804];
        const sNearDropoff = [4, 0, 8, 277, 1803, 2398, 2817, 5487, 1748, 656, 554, 805];
        const sDispatched = [107, 67, 54, 125, 132, 104, 291, 634, 1297, 2009, 1207, 1171];
        const sLeftPickup = [43, 23, 11, 25, 140, 172, 151, 271, 270, 454, 1051, 1929];
        const sNearPickup = [91, 101, 118, 77, 174, 239, 326, 499, 371, 560, 733, 923];
        const sPickedUp = [102, 79, 23, 12, 59, 64, 56, 67, 76, 111, 130, 190];
        const sSTV = [0, 0, 0, 0, 0, 0, 55, 119, 258, 628, 1074, 1518];
        const sOtros = [339, 357, 294, 621, 375, 554, 358, 330, 308, 800, 1256, 817];

        // COLORES PARA ESTADOS
        const stateColors = {
            'Accepted': '#E21B23',
            'Near Dropoff': '#F97316',
            'Dispatched': '#3B82F6',
            'Left Pickup': '#8B5CF6',
            'Near Pickup': '#06B6D4',
            'Picked Up': '#10B981',
            'STV': '#6366F1',
            'Otros': '#94A3B8'
        };

        const stateColorList = ['#E21B23', '#F97316', '#3B82F6', '#8B5CF6', '#06B6D4', '#10B981', '#6366F1', '#94A3B8'];
        const stateLabels = ['Accepted', 'Near Dropoff', 'Dispatched', 'Left Pickup', 'Near Pickup', 'Picked Up', 'STV', 'Otros'];
        const stateData = [sAccepted, sNearDropoff, sDispatched, sLeftPickup, sNearPickup, sPickedUp, sSTV, sOtros];

        // CONTENIDO DE STORYTELLING
        const hitosDetallados = [
            "Escenario anterior: Dotación incompleta, sufríamos estresando la capacidad humana para gestionar 1.2k-1.6k órdenes mensuales.",
            "Escenario anterior: Dotación incompleta, sufríamos estresando la capacidad humana para gestionar 1.2k-1.6k órdenes mensuales.",
            "Escenario anterior: Dotación incompleta, sufríamos estresando la capacidad humana para gestionar 1.2k-1.6k órdenes mensuales.",
            "Escenario anterior: Dotación incompleta, sufríamos estresando la capacidad humana para gestionar 1.2k-1.6k órdenes mensuales.",
            "Punto de Inflexión: Se aumenta umbral de autocomplete en órdenes con PIN a 180 min (vs 20 min las que no tienen PIN), crecen las stagnant en near dropoff y afectación operacional a nivel país.",
            "Estrés Crítico: Dotación completa y capacidad humana estresada por foco en órdenes stagnant + multitarea operativa intensa.",
            "Estrés Crítico: Dotación completa y capacidad humana estresada por multitarea, exige reestructuración de flujos y prioridades, para liberar capacidad para gestión de órdenes Stagnant.", 
            "Fase Experimental: Se integra data live para detección temprana. Comienza el desarrollo del Engine en fase testing gestionando stagnant en NDO. Se gestionan +5.1k órdenes con un FR de 0.1% (Bajo riesgo).",
            "Ajuste Estratégico: Business Case de agosto permite que Regional ajuste umbral de 180 a 40 min (2da semana): Stagnant en NDO desaparecen (0%). Automatización 54%.",
            "Gestión Proactiva: Implementación de gestión autonoma \"Scheduler\" cada 15 min. Transición a gestión proactiva permite superar las 10 mil órdenes gestionadas con share de automatización del 72%.",
            "Escalabilidad Real: Se ajusta umbral de gestión de \"Stagnant Accepted\" a >20 min. Automatización alcanza el 82% sobre un volumen masivo de 15 mil órdenes.",
            "Prueba de Fuego: Implementación Engine Dual. Superamos las 22 mil órdenes (88% auto), igualando toda la gestión manual del 2024 en solo 31 días."
        ];

        // REFERENCIAS DOM
        const overlay = document.getElementById('story-overlay');
        const overlayMonth = document.getElementById('story-month');
        const overlayText = document.getElementById('story-text');
        let automationChart;
        let currentChartView = 'engine-manual';
        let filteredState = null;

        // FUNCIÓN PARA FORMATEAR NÚMEROS
        function formatNumber(value) {
            if (value >= 1000) {
                return (value / 1000).toFixed(1) + 'k';
            }
            return value;
        }

        // FUNCIÓN PARA CAMBIAR VISTA DEL GRÁFICO
        function switchChartView(view) {
            currentChartView = view;
            filteredState = null;
            
            // Actualizar botones
            document.getElementById('toggleEngineManual').classList.toggle('active', view === 'engine-manual');
            document.getElementById('toggleByState').classList.toggle('active', view === 'by-state');

            // Destruir gráfico existente
            if (automationChart) {
                automationChart.destroy();
            }

            // Mostrar/ocultar storytelling
            if (view === 'engine-manual') {
                document.getElementById('story-overlay').style.display = 'flex';
                createEngineManualChart();
            } else {
                document.getElementById('story-overlay').style.display = 'none';
                createStateSegmentationChart();
            }
        }

        // CREAR GRÁFICO ENGINE/MANUAL
        function createEngineManualChart() {
            const ctxAuto = document.getElementById('automationChart').getContext('2d');
            automationChart = new Chart(ctxAuto, {
                type: 'bar',
                data: {
                    labels: mesesLabels,
                    datasets: [
                        { label: 'Engine', data: dataEngine, backgroundColor: '#E21B23', borderRadius: 6 },
                        { label: 'Manual', data: dataManual, backgroundColor: '#cbd5e1', borderRadius: 6 }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { display: false },
                        tooltip: { 
                            enabled: true,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            padding: 12,
                            titleFont: { size: 12, weight: 'bold' },
                            bodyFont: { size: 11 },
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + formatNumber(context.parsed.y);
                                }
                            }
                        }
                    },
                    onHover: (event, activeElements) => {
                        if (activeElements.length > 0) {
                            const index = activeElements[0].index;
                            overlayMonth.innerText = mesesLabels[index];
                            overlayText.innerText = hitosDetallados[index];
                            overlay.classList.add('active');
                        } else {
                            overlay.classList.remove('active');
                        }
                    },
                    scales: {
                        x: { stacked: true, grid: { display: false }, ticks: { font: { weight: '700', size: 11 } } },
                        y: { 
                            stacked: true,
                            beginAtZero: true,
                            grid: { color: '#f1f5f9' },
                            ticks: { callback: v => formatNumber(v) }
                        }
                    }
                }
            });
        }

        // CREAR GRÁFICO POR ESTADO
        function createStateSegmentationChart() {
            const datasets = stateLabels.map((label, idx) => ({
                label: label,
                data: stateData[idx],
                backgroundColor: stateColorList[idx],
                borderRadius: 6
            }));

            const ctxAuto = document.getElementById('automationChart').getContext('2d');
            automationChart = new Chart(ctxAuto, {
                type: 'bar',
                data: {
                    labels: mesesLabels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { 
                            display: true,
                            position: 'top',
                            onClick: function(e, legendItem, legend) {
                                const index = legendItem.datasetIndex;
                                toggleStateFilter(stateLabels[index]);
                            },
                            labels: {
                                padding: 15,
                                font: { size: 11, weight: 'bold' }
                            }
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + formatNumber(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            stacked: true, 
                            grid: { display: false }, 
                            ticks: { font: { weight: '700', size: 11 } } 
                        },
                        y: { 
                            stacked: true,
                            beginAtZero: true,
                            grid: { color: '#f1f5f9' },
                            ticks: { callback: v => formatNumber(v) }
                        }
                    }
                }
            });
        }

        // FILTRAR POR ESTADO
        function toggleStateFilter(state) {
            if (filteredState === state) {
                filteredState = null;
            } else {
                filteredState = state;
            }

            if (automationChart) {
                automationChart.destroy();
            }

            if (filteredState) {
                createFilteredStateChart();
            } else {
                createStateSegmentationChart();
            }
        }

        // CREAR GRÁFICO FILTRADO POR ESTADO
        function createFilteredStateChart() {
            const stateIndex = stateLabels.indexOf(filteredState);
            const stateDataValues = stateData[stateIndex];

            const ctxAuto = document.getElementById('automationChart').getContext('2d');
            automationChart = new Chart(ctxAuto, {
                type: 'bar',
                data: {
                    labels: mesesLabels,
                    datasets: [{
                        label: filteredState,
                        data: stateDataValues,
                        backgroundColor: stateColorList[stateIndex],
                        borderRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { 
                            display: true,
                            position: 'top',
                            onClick: function(e, legendItem, legend) {
                                filteredState = null;
                                createStateSegmentationChart();
                            },
                            labels: {
                                padding: 15,
                                font: { size: 11, weight: 'bold' }
                            }
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            padding: 12,
                            callbacks: {
                                title: function(context) {
                                    return filteredState;
                                },
                                label: function(context) {
                                    return 'Órdenes: ' + formatNumber(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            grid: { display: false }, 
                            ticks: { font: { weight: '700', size: 11 } } 
                        },
                        y: { 
                            beginAtZero: true,
                            grid: { color: '#f1f5f9' },
                            ticks: { callback: v => formatNumber(v) }
                        }
                    }
                }
            });
        }

        // CHART 2: EFECTIVIDAD
        const ctxEff = document.getElementById('effectivenessChart').getContext('2d');
        new Chart(ctxEff, {
            type: 'line',
            data: {
                labels: mesesLabels,
                datasets: [{
                    label: 'Efectividad %',
                    data: dataEfectividad,
                    borderColor: '#E21B23',
                    borderWidth: 4,
                    fill: true,
                    backgroundColor: 'rgba(226, 27, 35, 0.05)',
                    tension: 0.3,
                    pointBackgroundColor: '#fff',
                    pointBorderColor: '#E21B23',
                    pointBorderWidth: 3,
                    pointRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    x: { grid: { display: false }, ticks: { font: { weight: '600', size: 10 } } },
                    y: { min: 50, max: 100, grid: { borderDash: [5, 5] }, ticks: { callback: v => v + '%' } }
                }
            }
        });

        // INICIALIZAR GRÁFICO
        createEngineManualChart();

        // TOGGLE GRAPHICS FUNCTION FOR CASE STUDIES
        function toggleGraphics(event, caseId) {
            event.stopPropagation();
            const container = document.getElementById('case-studies-container');
            const graphicsId = caseId + '-graphics';
            const graphicsElement = document.getElementById(graphicsId);
            
            // Cerrar otros gráficos abiertos
            document.querySelectorAll('.case-study-graphics.active').forEach(el => {
                if (el.id !== graphicsId) {
                    el.classList.remove('active');
                }
            });
            
            // Toggle actual
            graphicsElement.classList.toggle('active');
        }

        // FUNCIONES PARA MODAL DE IMÁGENES
        function openImageModal(imageSrc) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            modalImage.src = imageSrc;
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // AGREGAR EVENT LISTENERS A LAS IMÁGENES DE GRÁFICOS
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.case-study-graphics img').forEach(img => {
                img.addEventListener('click', function(e) {
                    e.stopPropagation();
                    openImageModal(this.src);
                });
            });
        });

        // Cerrar gráficos al hacer click fuera
        document.addEventListener('click', () => {
            document.querySelectorAll('.case-study-graphics.active').forEach(el => {
                el.classList.remove('active');
            });
        });

        // Cerrar modal con tecla ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeImageModal();
                closeTimelinePopup();
            }
        });

        // FUNCIONES PARA POPUP DE TIMELINE
        function showTimelinePopup(event) {
            event.stopPropagation();
            const timelineItem = event.currentTarget;
            const stateName = timelineItem.getAttribute('data-state');
            const graphPath = timelineItem.getAttribute('data-graph');

            if (graphPath) {
                const titleMap = {
                    'dispatch': 'Dispatch',
                    'accepted': 'Accepted',
                    'near-pickup': 'Near Pickup',
                    'picked-up': 'Picked Up',
                    'left-pickup': 'Left Pickup',
                    'near-dropoff': 'Near Dropoff'
                };

                document.getElementById('timelinePopupTitle').innerText = titleMap[stateName] || stateName;
                document.getElementById('timelinePopupImage').src = graphPath;
                document.getElementById('timelinePopup').classList.add('active');
                document.getElementById('timelinePopupOverlay').classList.add('active');
            }
        }

        function closeTimelinePopup() {
            document.getElementById('timelinePopup').classList.remove('active');
            document.getElementById('timelinePopupOverlay').classList.remove('active');
        }

        // FUNCIONES PARA NOTAS DE RESPALDO
        function openBackupNote(imageName) {
            const modal = document.getElementById('backupNoteModal');
            const image = document.getElementById('backupNoteImage');
            image.src = 'stack/' + imageName;
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeBackupNote() {
            const modal = document.getElementById('backupNoteModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
    </script>
</body>
</html>